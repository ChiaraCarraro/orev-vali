import"./modulepreload-polyfill-B5Qt9EMX.js";var q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},se={exports:{}},ge;function Ie(){return ge||(ge=1,function(f,p){(function(l,t){f.exports=t()})(self,function(){return(()=>{var l={d:(s,a)=>{for(var d in a)l.o(a,d)&&!l.o(s,d)&&Object.defineProperty(s,d,{enumerable:!0,get:a[d]})},o:(s,a)=>Object.prototype.hasOwnProperty.call(s,a),r:s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})}},t={};l.r(t),l.d(t,{downloadVideo:()=>H,logMediaDevices:()=>b,modalContent:()=>g,openVideoPlayback:()=>M,openVideoPreview:()=>C,startRecorder:()=>h,startStream:()=>v,stopRecorder:()=>x,stopStream:()=>k,toggleModal:()=>w,uploadVideo:()=>P});const b=(s=!0,a=!0,d=!1)=>{navigator.mediaDevices.enumerateDevices().then(m=>{m.forEach(T=>{console.log(`${s&&T.kind.toUpperCase()}, ${a&&T.label}, ${d&&T.deviceId}`)})}).catch(m=>{console.log(m.name,m.message)})},w=()=>{window.location.href=window.location.href.indexOf("#greeting-modal")!==-1?"#":"#greeting-modal"},g=(s="<h1>Hi</h1>",a="deeppink")=>{const d=document.getElementById("modal-content");document.getElementById("modal").style.backgroundColor=a,s==="#video-preview"?(document.getElementById("video-playback").style.display="none",d.innerHTML="",document.getElementById("video-preview").style.display="block"):s==="#video-playback"?(document.getElementById("video-preview").style.display="none",d.innerHTML="",document.getElementById("video-playback").style.display="block"):(document.getElementById("video-preview").style.display="none",document.getElementById("video-playback").style.display="none",d.innerHTML=s),window.location.href="#greeting-modal"},C=()=>{g("#video-preview","white")},M=()=>{g("#video-playback","white")},v=(s={audio:!0,video:{facingMode:"user",frameRate:15}})=>{navigator.mediaDevices.getUserMedia(s).then(a=>{window.localStream=a;const d=document.querySelector("#video-preview");"srcObject"in d?d.srcObject=a:d.src=window.URL.createObjectURL(a),d.onloadedmetadata=()=>d.play()}).catch(a=>console.log(a.name,a.message))},k=()=>{"localStream"in window&&window.localStream.getTracks().forEach(s=>s.stop())},h=(s={audio:!0,video:{facingMode:"user"},frameRate:15})=>{let a={mimeType:"video/webm;codecs=vp9,opus"};MediaRecorder.isTypeSupported(a.mimeType)||(console.error(`${a.mimeType} is not supported, using vp8`),a={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(a.mimeType)||(console.error(`${a.mimeType} is not supported`),a={mimeType:"video/webm"},MediaRecorder.isTypeSupported(a.mimeType)||(console.error(`${a.mimeType} is not supported`),a={mimeType:""}))),navigator.mediaDevices.getUserMedia(s).then(d=>{window.localStream=d;const m=document.querySelector("#video-preview");"srcObject"in m?m.srcObject=d:m.src=window.URL.createObjectURL(d),m.onloadedmetadata=()=>m.play(),window.MediaRecorder=new MediaRecorder(window.localStream,a),window.dataChunks=[],window.MediaRecorder.start(),console.log(window.MediaRecorder.state),window.MediaRecorder.ondataavailable=T=>window.dataChunks.push(T.data)}).catch(d=>console.log(d.name,d.message))},x=()=>{"MediaRecorder"in window&&window.MediaRecorder.state==="recording"&&(window.MediaRecorder.stop(),console.log(window.MediaRecorder.state),window.MediaRecorder.onstop=()=>{window.blobvid=new Blob(window.dataChunks,{type:"video/webm"}),window.dataChunks=[],window.videoURL=window.URL.createObjectURL(window.blobvid),document.getElementById("video-playback").src=window.videoURL}),k()},P=(s,a="upload_video.php")=>{if(window.blobvid){const d={fname:new Date().toISOString().replaceAll(":","-").replace(".","-"),uploadContent:"<h1>Uploading</h1>",uploadColor:"coral",successContent:"<h1>Successful</h1>",successColor:"cyan",...s};g(d.uploadContent,d.uploadColor);const m=a,T=new FormData;T.append("vidfile",window.blobvid,d.fname),fetch(m,{method:"POST",body:T}).then(()=>{g(d.successContent,d.successColor)}).catch(console.error)}else g("<h1>No recording was found ðŸ˜”</h1>","PeachPuff")},H=(s="video.webm")=>{if(window.blobvid){console.log(s);const a=document.createElement("a");a.href=window.videoURL,a.download=s,a.click(),a.remove()}else console.log("No video found in window object")};return(()=>{const s=document.createElement("style");s.innerHTML=`
  /* Greeting Modal Container */
  #greeting-modal {
    visibility: hidden;
    opacity: 0;
    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);
  }
  
  /* Greeting Modal Container - when open */
  #greeting-modal:target {
    visibility: visible;
    opacity: 1;
  }
  
  /* Greeting Modal */
  #greeting-modal #modal {
    opacity: 0;
    transform: translateY(-1rem);
    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);
    transition-delay: 0.1s;
  }
  
  /* Greeting Modal - when open */
  #greeting-modal:target #modal {
  transform: translateY(0);
  opacity: 1;
  }
  
  /* Modal Container Styles for flex box */
  .modal-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
  }
  
  /* Modal Background Styles */
  .modal-bg {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(5px);
  }
  
  /* Modal Body Styles */
  #modal {
    z-index: 1;
    background-color: white;
    width: max-content; /* 500px */
    padding: 1rem;
    border-radius: 8px;
  }
  
  #modal .close {
    position: absolute;
    right: -16px;
    top: -16px;
    width: 32px;
    height: 32px;
    opacity: 0.3;
  }
  #modal .close:hover {
    opacity: 1;
  }

  #modal .close:before, .close:after {
    position: absolute;
    left: 16px;
    content: ' ';
    height: 34px;
    width: 3px;
    background-color: #333;
  }
  #modal .close:before {
    transform: rotate(45deg);
  }
  #modal .close:after {
    transform: rotate(-45deg);
  }
  
  
`,document.head.appendChild(s);const a=document.createRange().createContextualFragment(`
  <!-- Modal container -->
  <div class="modal-container" id="greeting-modal">

    <!-- Modal  -->
    <div id="modal">
      <video id="video-preview" muted style="display: none;"></video>
      <video id="video-playback" controls style="display: none"></video>
      <div id="modal-content"></div>
      <a href="#" class="close">
    </div>

    <!-- Background, click to close -->
    <a href="#" class="modal-bg"></a>
  </div>
`);document.body.appendChild(a)})(),t})()})}(se)),se.exports}var J=Ie(),ae={exports:{}},he;function Pe(){return he||(he=1,function(f){(function(){var p="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",Q=typeof process=="object"&&typeof process.versions=="object"&&process.versions.node&&!process.browser;if(Q){var l=process.versions.node.toString().replace("v","");p="Nodejs/"+l+" (NodeOS) AppleWebKit/"+l+" (KHTML, like Gecko) Nodejs/"+l+" Nodejs/"+l}(function(o){typeof window<"u"||(typeof window>"u"&&typeof q<"u"&&(q.navigator={userAgent:p,getUserMedia:function(){}},o.window=q),typeof location>"u"&&(o.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(o.screen={width:0,height:0}))})(typeof q<"u"?q:window);var t=window.navigator;typeof t<"u"?(typeof t.webkitGetUserMedia<"u"&&(t.getUserMedia=t.webkitGetUserMedia),typeof t.mozGetUserMedia<"u"&&(t.getUserMedia=t.mozGetUserMedia)):t={getUserMedia:function(){},userAgent:p};var b=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(t.userAgent||""),w=t.userAgent.indexOf("Edge")!==-1&&(!!t.msSaveOrOpenBlob||!!t.msSaveBlob),g=!!window.opera||t.userAgent.indexOf(" OPR/")>=0,C=t.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(t.userAgent),M=/^((?!chrome|android).)*safari/i.test(t.userAgent),v=!!window.chrome&&!g,k=typeof document<"u"&&!!document.documentMode&&!w;function h(){t.appVersion;var o=t.userAgent,i=t.appName,r=""+parseFloat(t.appVersion),c=parseInt(t.appVersion,10),n,u,D;if(g){i="Opera";try{r=t.userAgent.split("OPR/")[1].split(" ")[0],c=r.split(".")[0]}catch{r="0.0.0.0",c=0}}else k?(u=o.indexOf("rv:"),u>0?r=o.substring(u+3):(u=o.indexOf("MSIE"),r=o.substring(u+5)),i="IE"):v?(u=o.indexOf("Chrome"),i="Chrome",r=o.substring(u+7)):M?o.indexOf("CriOS")!==-1?(u=o.indexOf("CriOS"),i="Chrome",r=o.substring(u+6)):o.indexOf("FxiOS")!==-1?(u=o.indexOf("FxiOS"),i="Firefox",r=o.substring(u+6)):(u=o.indexOf("Safari"),i="Safari",r=o.substring(u+7),(u=o.indexOf("Version"))!==-1&&(r=o.substring(u+8)),t.userAgent.indexOf("Version/")!==-1&&(r=t.userAgent.split("Version/")[1].split(" ")[0])):C?(u=o.indexOf("Firefox"),i="Firefox",r=o.substring(u+8)):(n=o.lastIndexOf(" ")+1)<(u=o.lastIndexOf("/"))&&(i=o.substring(n,u),r=o.substring(u+1),i.toLowerCase()===i.toUpperCase()&&(i=t.appName));return w&&(i="Edge",r=t.userAgent.split("Edge/")[1]),(D=r.search(/[; \)]/))!==-1&&(r=r.substring(0,D)),c=parseInt(""+r,10),isNaN(c)&&(r=""+parseFloat(t.appVersion),c=parseInt(t.appVersion,10)),{fullVersion:r,version:c,name:i,isPrivateBrowsing:!1}}function x(o,i){var r=0,c=50,n=!1,u=window.setInterval(function(){o()&&(window.clearInterval(u),i(n)),r++>c&&(window.clearInterval(u),n=!0,i(n))},10)}function P(o){var i=o.toLowerCase();if(i.indexOf("msie")===0&&i.indexOf("trident")===0)return!1;var r=/(?:msie|rv:)\s?([\d\.]+)/.exec(i);return!!(r&&parseInt(r[1],10)>=10)}function H(o){var i;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){i=!1},function(c){i=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{r=window.indexedDB.open("test"),r.onerror=function(){return!0}}catch{i=!0}typeof i>"u"&&x(function(){return r.readyState==="done"},function(n){n||(i=!r.result)})}else if(P(window.navigator.userAgent)){i=!1;try{window.indexedDB||(i=!0)}catch{i=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch{i=!0}typeof i>"u"&&(i=!1,window.localStorage.removeItem("test"))}}catch{i=!1}x(function(){return typeof i<"u"},function(n){o(i)})}var s={Android:function(){return t.userAgent.match(/Android/i)},BlackBerry:function(){return t.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return t.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return t.userAgent.match(/Opera Mini/i)},Windows:function(){return t.userAgent.match(/IEMobile/i)},any:function(){return s.Android()||s.BlackBerry()||s.iOS()||s.Opera()||s.Windows()},getOsName:function(){var o="Unknown OS";return s.Android()&&(o="Android"),s.BlackBerry()&&(o="BlackBerry"),s.iOS()&&(o="iOS"),s.Opera()&&(o="Opera Mini"),s.Windows()&&(o="Windows"),o}};function a(){for(var o="-",i=t.appVersion,r=t.userAgent,c=o,n=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],u=0,D;D=n[u];u++)if(D.r.test(r)){c=D.s;break}var S=o;switch(/Windows/.test(c)&&(/Windows (.*)/.test(c)&&(S=/Windows (.*)/.exec(c)[1]),c="Windows"),c){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(r)&&(S=/Mac OS X (10[\.\_\d]+)/.exec(r)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(r)&&(S=/Android ([\.\_\d]+)/.exec(r)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(r)&&(S=/OS (\d+)_(\d+)_?(\d+)?/.exec(i),S&&S.length>3&&(S=S[1]+"."+S[2]+"."+(S[3]|0)));break}return{osName:c,osVersion:S}}var d="Unknown OS",m="Unknown OS Version";function T(o){o=(o||t.userAgent).toLowerCase();var i=o.match(/android\s([0-9\.]*)/);return i?i[1]:!1}var U=a();U&&U.osName&&U.osName!="-"?(d=U.osName,m=U.osVersion):s.any()&&(d=s.getOsName(),d=="Android"&&(m=T()));var Q=typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;d==="Unknown OS"&&Q&&(d="Nodejs",m=process.versions.node.toString().replace("v",""));var Z=!1,ee=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(o){typeof document>"u"||typeof document.createElement!="function"||(!Z&&o in document.createElement("canvas")&&(Z=!0),!ee&&o in document.createElement("video")&&(ee=!0))});var de=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,Se=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,ye=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;function Ce(o,i){if(e.isWebRTCSupported){var r=!0,c=!0;ke(function(n){n?n.match(de)?(r=!1,o("Local: "+n,r,c)):(n.match(ye)&&(c=!1),o("Public: "+n,r,c)):o()},i)}}function ke(o,i){if(typeof document>"u"||typeof document.getElementById!="function")return;var r={},c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!c){var n=document.getElementById("iframe");if(!n)return;var u=n.contentWindow;c=u.RTCPeerConnection||u.mozRTCPeerConnection||u.webkitRTCPeerConnection}if(!c)return;var D=null;e.browser==="Chrome"&&e.browser.version<58&&(D={optional:[{RtpDataChannels:!0}]});var S={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},O=new c(S,D);i&&(O.addStream?O.addStream(i):O.addTrack&&i.getTracks()[0]&&O.addTrack(i.getTracks()[0],i));function ie(y){if(!y){o();return}var j=Se.exec(y);if(j){var re=j[1],Re=y.match(de),We=!0;r[re]===void 0&&o(re,Re,We),r[re]=!0}}if(O.onicecandidate=function(y){y.candidate&&y.candidate.candidate?ie(y.candidate.candidate):ie()},!i)try{O.createDataChannel("sctp",{})}catch{}e.isPromisesSupported?O.createOffer().then(function(y){O.setLocalDescription(y).then(ve)}):O.createOffer(function(y){O.setLocalDescription(y,ve,function(){})},function(){});function ve(){var y=O.localDescription.sdp.split(`
`);y.forEach(function(j){j&&j.indexOf("a=candidate:")===0&&ie(j)})}}var N=[],E=[],A=[],B=[];t.mediaDevices&&t.mediaDevices.enumerateDevices&&(t.enumerateDevices=function(o){var i=t.mediaDevices.enumerateDevices();i&&i.then?t.mediaDevices.enumerateDevices().then(o).catch(function(){o([])}):o([])});var oe=!1;(typeof MediaStreamTrack<"u"&&"getSources"in MediaStreamTrack||t.mediaDevices&&t.mediaDevices.enumerateDevices)&&(oe=!0);var z=!1,X=!1,K=!1,L=!1,F=!1;function Te(o){if(!oe){o&&o();return}if(!t.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(t.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!t.enumerateDevices&&t.enumerateDevices&&(t.enumerateDevices=t.enumerateDevices.bind(t)),!t.enumerateDevices){o&&o();return}N=[],E=[],A=[],B=[],z=!1,X=!1,K=!1,L=!1,F=!1;var i={};t.enumerateDevices(function(r){N=[],E=[],A=[],B=[],r.forEach(function(c){var n={};for(var u in c)try{typeof c[u]!="function"&&(n[u]=c[u])}catch{}i[n.deviceId+n.label+n.kind]||(n.kind==="audio"&&(n.kind="audioinput"),n.kind==="video"&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?(n.kind==="videoinput"&&!F&&(F=!0),n.kind==="audioinput"&&!L&&(L=!0)):(n.isCustomLabel=!0,n.kind==="videoinput"?n.label="Camera "+(B.length+1):n.kind==="audioinput"?n.label="Microphone "+(E.length+1):n.kind==="audiooutput"?n.label="Speaker "+(A.length+1):n.label="Please invoke getUserMedia once.",typeof e<"u"&&e.browser.isChrome&&e.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&typeof document<"u"&&typeof document.domain=="string"&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),n.kind==="audioinput"&&(z=!0,E.indexOf(n)===-1&&E.push(n)),n.kind==="audiooutput"&&(X=!0,A.indexOf(n)===-1&&A.push(n)),n.kind==="videoinput"&&(K=!0,B.indexOf(n)===-1&&B.push(n)),N.push(n),i[n.deviceId+n.label+n.kind]=n)}),typeof e<"u"&&(e.MediaDevices=N,e.hasMicrophone=z,e.hasSpeakers=X,e.hasWebcam=K,e.isWebsiteHasWebcamPermissions=F,e.isWebsiteHasMicrophonePermissions=L,e.audioInputDevices=E,e.audioOutputDevices=A,e.videoInputDevices=B),o&&o()})}var e=window.DetectRTC||{};e.browser=h(),H(function(o){e.browser.isPrivateBrowsing=!!o}),e.browser["is"+e.browser.name]=!0,e.osName=d,e.osVersion=m,typeof process=="object"&&typeof process.versions=="object"&&process.versions["node-webkit"];var te=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(o){te||o in window&&(te=!0)}),e.isWebRTCSupported=te,e.isORTCSupported=typeof RTCIceGatherer<"u";var W=!1;if((e.browser.isChrome&&e.browser.version>=35||e.browser.isFirefox&&e.browser.version>=34||e.browser.isEdge&&e.browser.version>=17||e.osName==="Android"&&e.browser.isChrome)&&(W=!0),(t.getDisplayMedia||t.mediaDevices&&t.mediaDevices.getDisplayMedia)&&(W=!0),!/^(https:|chrome-extension:)$/g.test(location.protocol||"")){var Me=typeof document<"u"&&typeof document.domain=="string"&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1;(Me&&(e.browser.isChrome||e.browser.isEdge||e.browser.isOpera)||e.browser.isFirefox)&&(W=!1)}e.isScreenCapturingSupported=W;var V={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(o){V.isSupported||o in window&&(V.isSupported=!0,window[o]&&"createMediaStreamSource"in window[o].prototype&&(V.isCreateMediaStreamSourceSupported=!0))}),e.isAudioContextSupported=V.isSupported,e.isCreateMediaStreamSourceSupported=V.isCreateMediaStreamSourceSupported;var ce=!1;e.browser.isChrome&&e.browser.version>31&&(ce=!0),e.isRtpDataChannelsSupported=ce;var Y=!1;(e.browser.isFirefox&&e.browser.version>28||e.browser.isChrome&&e.browser.version>25||e.browser.isOpera&&e.browser.version>=11)&&(Y=!0),e.isSctpDataChannelsSupported=Y,e.isMobileDevice=b;var _=!1;(t.getUserMedia||t.mediaDevices&&t.mediaDevices.getUserMedia)&&(_=!0),e.browser.isChrome&&e.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&typeof document<"u"&&typeof document.domain=="string"&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1&&(_="Requires HTTPs"),e.osName==="Nodejs"&&(_=!1),e.isGetUserMediaSupported=_;var le="";if(screen.width){var Oe=screen.width?screen.width:"",xe=screen.height?screen.height:"";le+=""+Oe+" x "+xe}e.displayResolution=le;function De(o,i){function r(n,u){return u==0?n:r(u,n%u)}var c=r(o,i);return o/c/(i/c)}e.displayAspectRatio=De(screen.width,screen.height).toFixed(2),e.isCanvasSupportsStreamCapturing=Z,e.isVideoSupportsStreamCapturing=ee,e.browser.name=="Chrome"&&e.browser.version>=53&&(e.isCanvasSupportsStreamCapturing||(e.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),e.isVideoSupportsStreamCapturing||(e.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),e.DetectLocalIPAddress=Ce,e.isWebSocketsSupported="WebSocket"in window&&window.WebSocket.CLOSING===2,e.isWebSocketsBlocked=!e.isWebSocketsSupported,e.osName==="Nodejs"&&(e.isWebSocketsSupported=!0,e.isWebSocketsBlocked=!1),e.checkWebSocketsSupport=function(o){o=o||function(){};try{var i,r=new WebSocket("wss://echo.websocket.org:443/");r.onopen=function(){e.isWebSocketsBlocked=!1,i=new Date().getTime(),r.send("ping")},r.onmessage=function(){e.WebsocketLatency=new Date().getTime()-i+"ms",o(),r.close(),r=null},r.onerror=function(){e.isWebSocketsBlocked=!0,o()}}catch{e.isWebSocketsBlocked=!0,o()}},e.load=function(o){o=o||function(){},Te(o)},typeof N<"u"?e.MediaDevices=N:e.MediaDevices=[],e.hasMicrophone=z,e.hasSpeakers=X,e.hasWebcam=K,e.isWebsiteHasWebcamPermissions=F,e.isWebsiteHasMicrophonePermissions=L,e.audioInputDevices=E,e.audioOutputDevices=A,e.videoInputDevices=B;var ue=!1;typeof document<"u"&&typeof document.createElement=="function"&&"setSinkId"in document.createElement("video")&&(ue=!0),e.isSetSinkIdSupported=ue;var ne=!1;e.browser.isFirefox&&typeof mozRTCPeerConnection<"u"?"getSenders"in mozRTCPeerConnection.prototype&&(ne=!0):e.browser.isChrome&&typeof webkitRTCPeerConnection<"u"&&"getSenders"in webkitRTCPeerConnection.prototype&&(ne=!0),e.isRTPSenderReplaceTracksSupported=ne;var pe=!1;e.browser.isFirefox&&e.browser.version>38&&(pe=!0),e.isRemoteStreamProcessingSupported=pe;var fe=!1;typeof MediaStreamTrack<"u"&&"applyConstraints"in MediaStreamTrack.prototype&&(fe=!0),e.isApplyConstraintsSupported=fe;var me=!1;e.browser.isFirefox&&e.browser.version>=43&&(me=!0),e.isMultiMonitorScreenCapturingSupported=me,e.isPromisesSupported="Promise"in window,e.version="1.4.1",typeof e>"u"&&(window.DetectRTC={});var $=window.MediaStream;typeof $>"u"&&typeof webkitMediaStream<"u"&&($=webkitMediaStream),typeof $<"u"&&typeof $=="function"?e.MediaStream=Object.keys($.prototype):e.MediaStream=!1,typeof MediaStreamTrack<"u"?e.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):e.MediaStreamTrack=!1;var we=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;typeof we<"u"?e.RTCPeerConnection=Object.keys(we.prototype):e.RTCPeerConnection=!1,window.DetectRTC=e,f.exports=e})()}(ae)),ae.exports}var G=Pe();function Ee(f,p){f.forEach(h=>{h.subjID=p,h.correct=h.targetWord===h.chosenWord});const l=["subjID","trial","wordClass","targetWord","chosenWord","chosenCategory","chosenPosition","correct","timestamp","responseTime"],t=["id","trial","word_class","target_word","chosen_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"],b=[];b.push(t),f.forEach(h=>{const x=l.map(P=>h[P]);b.push(x)});let w="";b.forEach(h=>{w+=h.join(",")+`
`});const g=new Date().toISOString().substring(0,10),C=new Date().toISOString().slice(11,19).replaceAll(":","-"),M=new Blob([w],{type:"text/csv;charset=utf-8,"}),v=URL.createObjectURL(M),k=document.createElement("a");k.setAttribute("href",v),k.setAttribute("download",`orev-${p}-${g}-${C}.csv`),k.click()}function Ae(f,p){f.forEach(v=>{v.subjID=p,v.correct=v.targetWord===v.chosenWord});const l=["subjID","trial","wordClass","targetWord","chosenWord","chosenCategory","chosenPosition","correct","timestamp","responseTime"],t=["id","trial","word_class","target_word","chosen_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"],b=[];b.push(t),f.forEach(v=>{const k=l.map(h=>v[h]);b.push(k)});let w="";b.forEach(v=>{w+=v.join(",")+`
`});const g=new Date().toISOString().substring(0,10),C=new Date().toISOString().slice(11,19).replaceAll(":","-"),M=new FormData;M.append("csvFile",new Blob([w],{type:"text/csv"}),`orev-${p}-${g}-${C}.csv`),fetch("./data/data.php",{method:"POST",body:M}).then(v=>v.text()).then(v=>{console.log("Success:",v)}).catch(v=>{console.error("Error:",v)})}const I=f=>new Promise(p=>setTimeout(p,f)),Be=()=>{const f=document.documentElement;f.requestFullscreen?f.requestFullscreen():f.webkitRequestFullscreen?f.webkitRequestFullscreen():f.msRequestFullscreen&&f.msRequestFullscreen()},Ne=()=>{let f=!1;if("maxTouchPoints"in navigator)f=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)f=navigator.msMaxTouchPoints>0;else{const p=window.matchMedia&&matchMedia("(pointer:coarse)");if(p&&p.media==="(pointer:coarse)")f=!!p.matches;else if("orientation"in window)f=!0;else{const l=navigator.userAgent;f=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(l)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(l)}}return f},be=localStorage.getItem("storedChoices");let R;be?R=JSON.parse(be):console.error("No data found in local storage");document.addEventListener("DOMContentLoaded",function(){const f=document.querySelectorAll(".trials");f.forEach((s,a)=>{s.id=`trial${a}`});const p={meta:{subjID:(R==null?void 0:R.ID)||"testID",order:window.location.pathname.split("/").pop().replace(".html",""),touchscreen:Ne(),webcam:(R==null?void 0:R.webcam)==="true"||!1,saving:(R==null?void 0:R.saving)||"download"},data:[]};G.load(()=>{p.meta.os=G.osName,p.meta.browser=G.browser.name,p.meta.browserVersion=JSON.stringify(G.browser.version),p.meta.safari=G.browser.isSafari||!1,p.meta.iOSSafari=p.meta.touchscreen&&p.meta.safari});let l=0,t=0,b=0;const w=document.getElementsByTagName("audio"),g=document.getElementById("between-trials"),C=document.getElementById("orev-button"),M=document.getElementById("speaker"),v=document.getElementById("heading-fullscreen"),k=document.getElementById("heading-testsound"),h=async s=>{s.preventDefault(),b=new Date().getTime();const a=document.getElementById(`trial${l-1}`);Array.from(a.getElementsByTagName("img")).forEach(m=>{m.style.border="0.3vw solid black"}),s.target.style.border="0.3vw solid blue",p.data[l-2]={timestamp:new Date(parseInt(b)).toISOString(),responseTime:b-t,trial:l-1,targetWord:w[l-1].src.split("/").pop().replace("N_","").replace("V_","").replace("zm_","").replace(".mp3",""),chosenWord:s.target.src.split("/").pop().replace("N_","").replace("V_","").replace(".jpeg",""),chosenCategory:s.target.dataset.wordCategory,chosenPosition:s.target.classList[0],wordClass:w[l-1].src.split("/").pop().startsWith("N_")?"noun":w[l-1].src.split("/").pop().startsWith("V_")?"verb":"unknown"},C.addEventListener("click",x,{capture:!1,once:!0})},x=async s=>{if(s.preventDefault(),l===0&&(!0&!p.meta.iOSSafari&&Be(),v.style.display="none",k.style.display="inline",M.setAttribute("visibility","visible"),await I(1e3),w[l].play(),await I(1e3),C.addEventListener("click",x,{capture:!1,once:!0})),l===f.length){try{await Ee(p.data,p.meta.subjID)}catch(a){console.warn("Failed to download",a)}try{await Ae(p.data,p.meta.subjID)}catch(a){console.warn("Failed to upload:",a)}if(!p.meta.iOSSafari&&p.meta.webcam){J.stopRecorder();const a=new Date().toISOString().substring(0,10),d=new Date().toISOString().slice(11,19).replaceAll(":","-");await I(2e3),await I(2e3);try{await J.downloadVideo(`orev-${p.meta.subjID}-${a}-${d}`)}catch(m){console.warn("Failed to download video:",m)}try{await J.uploadVideo({fname:`orev-${p.meta.subjID}-${a}-${d}`,uploadContent:`<img src='/orev-vn/images/spinner-upload-de.svg' style="width: 75vw">`,uploadColor:"#E1B4B4",successContent:`<img src='/orev-vn/images/spinner-done-de.svg' style="width: 75vw">`,successColor:"#D3F9D3"},"./data/upload_video.php")}catch(m){console.warn("Failed to upload video:",m)}}window.location.href="https://devpsy.web.leuphana.de/orev-vali-consent/goodbye.html"}if(l>0){k.style.display="none",w[l-1].pause(),w[l-1].currentTime=0;const a=document.getElementById(`trial${l-1}`);a.style.display="none",g.style.display="flex",await I(150),w[l].play(),await I(0),t=new Date().getTime(),g.style.display="none";const d=document.getElementById(`trial${l}`);d.style.display="flex";const m=Array.from(d.getElementsByTagName("img"));w[l].onended=()=>{m.forEach(T=>{T.addEventListener("click",h,{capture:!1,once:!1})})}}l++},P=async s=>{s.preventDefault(),l>1&&(w[l-1].pause(),w[l-1].currentTime=0),w[l-1].play()};C.addEventListener("click",x,{capture:!1,once:!0}),M.addEventListener("click",P,{capture:!1,once:!1}),(async()=>{await I(500),!p.meta.iOSSafari&&p.meta.webcam&&J.startRecorder({audio:!0,video:{frameRate:{min:3,ideal:3,max:3},width:{min:80,ideal:80,max:80},height:{min:60,ideal:60,max:60},facingMode:"user"}}),await I(2500),C.style.display="inline",C.disabled=!1})()});
