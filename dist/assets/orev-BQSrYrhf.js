import"./modulepreload-polyfill-B5Qt9EMX.js";var G=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},se={exports:{}},ge;function We(){return ge||(ge=1,function(f,l){(function(u,o){f.exports=o()})(self,function(){return(()=>{var u={d:(s,a)=>{for(var d in a)u.o(a,d)&&!u.o(s,d)&&Object.defineProperty(s,d,{enumerable:!0,get:a[d]})},o:(s,a)=>Object.prototype.hasOwnProperty.call(s,a),r:s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})}},o={};u.r(o),u.d(o,{downloadVideo:()=>z,logMediaDevices:()=>h,modalContent:()=>g,openVideoPlayback:()=>O,openVideoPreview:()=>C,startRecorder:()=>b,startStream:()=>w,stopRecorder:()=>I,stopStream:()=>k,toggleModal:()=>m,uploadVideo:()=>P});const h=(s=!0,a=!0,d=!1)=>{navigator.mediaDevices.enumerateDevices().then(v=>{v.forEach(T=>{console.log(`${s&&T.kind.toUpperCase()}, ${a&&T.label}, ${d&&T.deviceId}`)})}).catch(v=>{console.log(v.name,v.message)})},m=()=>{window.location.href=window.location.href.indexOf("#greeting-modal")!==-1?"#":"#greeting-modal"},g=(s="<h1>Hi</h1>",a="deeppink")=>{const d=document.getElementById("modal-content");document.getElementById("modal").style.backgroundColor=a,s==="#video-preview"?(document.getElementById("video-playback").style.display="none",d.innerHTML="",document.getElementById("video-preview").style.display="block"):s==="#video-playback"?(document.getElementById("video-preview").style.display="none",d.innerHTML="",document.getElementById("video-playback").style.display="block"):(document.getElementById("video-preview").style.display="none",document.getElementById("video-playback").style.display="none",d.innerHTML=s),window.location.href="#greeting-modal"},C=()=>{g("#video-preview","white")},O=()=>{g("#video-playback","white")},w=(s={audio:!0,video:{facingMode:"user",frameRate:15}})=>{navigator.mediaDevices.getUserMedia(s).then(a=>{window.localStream=a;const d=document.querySelector("#video-preview");"srcObject"in d?d.srcObject=a:d.src=window.URL.createObjectURL(a),d.onloadedmetadata=()=>d.play()}).catch(a=>console.log(a.name,a.message))},k=()=>{"localStream"in window&&window.localStream.getTracks().forEach(s=>s.stop())},b=(s={audio:!0,video:{facingMode:"user"},frameRate:15})=>{let a={mimeType:"video/webm;codecs=vp9,opus"};MediaRecorder.isTypeSupported(a.mimeType)||(console.error(`${a.mimeType} is not supported, using vp8`),a={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(a.mimeType)||(console.error(`${a.mimeType} is not supported`),a={mimeType:"video/webm"},MediaRecorder.isTypeSupported(a.mimeType)||(console.error(`${a.mimeType} is not supported`),a={mimeType:""}))),navigator.mediaDevices.getUserMedia(s).then(d=>{window.localStream=d;const v=document.querySelector("#video-preview");"srcObject"in v?v.srcObject=d:v.src=window.URL.createObjectURL(d),v.onloadedmetadata=()=>v.play(),window.MediaRecorder=new MediaRecorder(window.localStream,a),window.dataChunks=[],window.MediaRecorder.start(),console.log(window.MediaRecorder.state),window.MediaRecorder.ondataavailable=T=>window.dataChunks.push(T.data)}).catch(d=>console.log(d.name,d.message))},I=()=>{"MediaRecorder"in window&&window.MediaRecorder.state==="recording"&&(window.MediaRecorder.stop(),console.log(window.MediaRecorder.state),window.MediaRecorder.onstop=()=>{window.blobvid=new Blob(window.dataChunks,{type:"video/webm"}),window.dataChunks=[],window.videoURL=window.URL.createObjectURL(window.blobvid),document.getElementById("video-playback").src=window.videoURL}),k()},P=(s,a="upload_video.php")=>{if(window.blobvid){const d={fname:new Date().toISOString().replaceAll(":","-").replace(".","-"),uploadContent:"<h1>Uploading</h1>",uploadColor:"coral",successContent:"<h1>Successful</h1>",successColor:"cyan",...s};g(d.uploadContent,d.uploadColor);const v=a,T=new FormData;T.append("vidfile",window.blobvid,d.fname),fetch(v,{method:"POST",body:T}).then(()=>{g(d.successContent,d.successColor)}).catch(console.error)}else g("<h1>No recording was found ðŸ˜”</h1>","PeachPuff")},z=(s="video.webm")=>{if(window.blobvid){console.log(s);const a=document.createElement("a");a.href=window.videoURL,a.download=s,a.click(),a.remove()}else console.log("No video found in window object")};return(()=>{const s=document.createElement("style");s.innerHTML=`
  /* Greeting Modal Container */
  #greeting-modal {
    visibility: hidden;
    opacity: 0;
    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);
  }
  
  /* Greeting Modal Container - when open */
  #greeting-modal:target {
    visibility: visible;
    opacity: 1;
  }
  
  /* Greeting Modal */
  #greeting-modal #modal {
    opacity: 0;
    transform: translateY(-1rem);
    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);
    transition-delay: 0.1s;
  }
  
  /* Greeting Modal - when open */
  #greeting-modal:target #modal {
  transform: translateY(0);
  opacity: 1;
  }
  
  /* Modal Container Styles for flex box */
  .modal-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
  }
  
  /* Modal Background Styles */
  .modal-bg {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(5px);
  }
  
  /* Modal Body Styles */
  #modal {
    z-index: 1;
    background-color: white;
    width: max-content; /* 500px */
    padding: 1rem;
    border-radius: 8px;
  }
  
  #modal .close {
    position: absolute;
    right: -16px;
    top: -16px;
    width: 32px;
    height: 32px;
    opacity: 0.3;
  }
  #modal .close:hover {
    opacity: 1;
  }

  #modal .close:before, .close:after {
    position: absolute;
    left: 16px;
    content: ' ';
    height: 34px;
    width: 3px;
    background-color: #333;
  }
  #modal .close:before {
    transform: rotate(45deg);
  }
  #modal .close:after {
    transform: rotate(-45deg);
  }
  
  
`,document.head.appendChild(s);const a=document.createRange().createContextualFragment(`
  <!-- Modal container -->
  <div class="modal-container" id="greeting-modal">

    <!-- Modal  -->
    <div id="modal">
      <video id="video-preview" muted style="display: none;"></video>
      <video id="video-playback" controls style="display: none"></video>
      <div id="modal-content"></div>
      <a href="#" class="close">
    </div>

    <!-- Background, click to close -->
    <a href="#" class="modal-bg"></a>
  </div>
`);document.body.appendChild(a)})(),o})()})}(se)),se.exports}var U=We(),ae={exports:{}},be;function Pe(){return be||(be=1,function(f){(function(){var l="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",Q=typeof process=="object"&&typeof process.versions=="object"&&process.versions.node&&!process.browser;if(Q){var u=process.versions.node.toString().replace("v","");l="Nodejs/"+u+" (NodeOS) AppleWebKit/"+u+" (KHTML, like Gecko) Nodejs/"+u+" Nodejs/"+u}(function(t){typeof window<"u"||(typeof window>"u"&&typeof G<"u"&&(G.navigator={userAgent:l,getUserMedia:function(){}},t.window=G),typeof location>"u"&&(t.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(t.screen={width:0,height:0}))})(typeof G<"u"?G:window);var o=window.navigator;typeof o<"u"?(typeof o.webkitGetUserMedia<"u"&&(o.getUserMedia=o.webkitGetUserMedia),typeof o.mozGetUserMedia<"u"&&(o.getUserMedia=o.mozGetUserMedia)):o={getUserMedia:function(){},userAgent:l};var h=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(o.userAgent||""),m=o.userAgent.indexOf("Edge")!==-1&&(!!o.msSaveOrOpenBlob||!!o.msSaveBlob),g=!!window.opera||o.userAgent.indexOf(" OPR/")>=0,C=o.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(o.userAgent),O=/^((?!chrome|android).)*safari/i.test(o.userAgent),w=!!window.chrome&&!g,k=typeof document<"u"&&!!document.documentMode&&!m;function b(){o.appVersion;var t=o.userAgent,i=o.appName,r=""+parseFloat(o.appVersion),c=parseInt(o.appVersion,10),n,p,R;if(g){i="Opera";try{r=o.userAgent.split("OPR/")[1].split(" ")[0],c=r.split(".")[0]}catch{r="0.0.0.0",c=0}}else k?(p=t.indexOf("rv:"),p>0?r=t.substring(p+3):(p=t.indexOf("MSIE"),r=t.substring(p+5)),i="IE"):w?(p=t.indexOf("Chrome"),i="Chrome",r=t.substring(p+7)):O?t.indexOf("CriOS")!==-1?(p=t.indexOf("CriOS"),i="Chrome",r=t.substring(p+6)):t.indexOf("FxiOS")!==-1?(p=t.indexOf("FxiOS"),i="Firefox",r=t.substring(p+6)):(p=t.indexOf("Safari"),i="Safari",r=t.substring(p+7),(p=t.indexOf("Version"))!==-1&&(r=t.substring(p+8)),o.userAgent.indexOf("Version/")!==-1&&(r=o.userAgent.split("Version/")[1].split(" ")[0])):C?(p=t.indexOf("Firefox"),i="Firefox",r=t.substring(p+8)):(n=t.lastIndexOf(" ")+1)<(p=t.lastIndexOf("/"))&&(i=t.substring(n,p),r=t.substring(p+1),i.toLowerCase()===i.toUpperCase()&&(i=o.appName));return m&&(i="Edge",r=o.userAgent.split("Edge/")[1]),(R=r.search(/[; \)]/))!==-1&&(r=r.substring(0,R)),c=parseInt(""+r,10),isNaN(c)&&(r=""+parseFloat(o.appVersion),c=parseInt(o.appVersion,10)),{fullVersion:r,version:c,name:i,isPrivateBrowsing:!1}}function I(t,i){var r=0,c=50,n=!1,p=window.setInterval(function(){t()&&(window.clearInterval(p),i(n)),r++>c&&(window.clearInterval(p),n=!0,i(n))},10)}function P(t){var i=t.toLowerCase();if(i.indexOf("msie")===0&&i.indexOf("trident")===0)return!1;var r=/(?:msie|rv:)\s?([\d\.]+)/.exec(i);return!!(r&&parseInt(r[1],10)>=10)}function z(t){var i;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){i=!1},function(c){i=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{r=window.indexedDB.open("test"),r.onerror=function(){return!0}}catch{i=!0}typeof i>"u"&&I(function(){return r.readyState==="done"},function(n){n||(i=!r.result)})}else if(P(window.navigator.userAgent)){i=!1;try{window.indexedDB||(i=!0)}catch{i=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch{i=!0}typeof i>"u"&&(i=!1,window.localStorage.removeItem("test"))}}catch{i=!1}I(function(){return typeof i<"u"},function(n){t(i)})}var s={Android:function(){return o.userAgent.match(/Android/i)},BlackBerry:function(){return o.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return o.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return o.userAgent.match(/Opera Mini/i)},Windows:function(){return o.userAgent.match(/IEMobile/i)},any:function(){return s.Android()||s.BlackBerry()||s.iOS()||s.Opera()||s.Windows()},getOsName:function(){var t="Unknown OS";return s.Android()&&(t="Android"),s.BlackBerry()&&(t="BlackBerry"),s.iOS()&&(t="iOS"),s.Opera()&&(t="Opera Mini"),s.Windows()&&(t="Windows"),t}};function a(){for(var t="-",i=o.appVersion,r=o.userAgent,c=t,n=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],p=0,R;R=n[p];p++)if(R.r.test(r)){c=R.s;break}var S=t;switch(/Windows/.test(c)&&(/Windows (.*)/.test(c)&&(S=/Windows (.*)/.exec(c)[1]),c="Windows"),c){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(r)&&(S=/Mac OS X (10[\.\_\d]+)/.exec(r)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(r)&&(S=/Android ([\.\_\d]+)/.exec(r)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(r)&&(S=/OS (\d+)_(\d+)_?(\d+)?/.exec(i),S&&S.length>3&&(S=S[1]+"."+S[2]+"."+(S[3]|0)));break}return{osName:c,osVersion:S}}var d="Unknown OS",v="Unknown OS Version";function T(t){t=(t||o.userAgent).toLowerCase();var i=t.match(/android\s([0-9\.]*)/);return i?i[1]:!1}var L=a();L&&L.osName&&L.osName!="-"?(d=L.osName,v=L.osVersion):s.any()&&(d=s.getOsName(),d=="Android"&&(v=T()));var Q=typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;d==="Unknown OS"&&Q&&(d="Nodejs",v=process.versions.node.toString().replace("v",""));var Z=!1,ee=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(t){typeof document>"u"||typeof document.createElement!="function"||(!Z&&t in document.createElement("canvas")&&(Z=!0),!ee&&t in document.createElement("video")&&(ee=!0))});var de=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,Se=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,ye=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;function Ce(t,i){if(e.isWebRTCSupported){var r=!0,c=!0;ke(function(n){n?n.match(de)?(r=!1,t("Local: "+n,r,c)):(n.match(ye)&&(c=!1),t("Public: "+n,r,c)):t()},i)}}function ke(t,i){if(typeof document>"u"||typeof document.getElementById!="function")return;var r={},c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!c){var n=document.getElementById("iframe");if(!n)return;var p=n.contentWindow;c=p.RTCPeerConnection||p.mozRTCPeerConnection||p.webkitRTCPeerConnection}if(!c)return;var R=null;e.browser==="Chrome"&&e.browser.version<58&&(R={optional:[{RtpDataChannels:!0}]});var S={iceServers:[{urls:"stun:stun.l.google.com:19302"}]},M=new c(S,R);i&&(M.addStream?M.addStream(i):M.addTrack&&i.getTracks()[0]&&M.addTrack(i.getTracks()[0],i));function ie(y){if(!y){t();return}var j=Se.exec(y);if(j){var re=j[1],Ie=y.match(de),Re=!0;r[re]===void 0&&t(re,Ie,Re),r[re]=!0}}if(M.onicecandidate=function(y){y.candidate&&y.candidate.candidate?ie(y.candidate.candidate):ie()},!i)try{M.createDataChannel("sctp",{})}catch{}e.isPromisesSupported?M.createOffer().then(function(y){M.setLocalDescription(y).then(ve)}):M.createOffer(function(y){M.setLocalDescription(y,ve,function(){})},function(){});function ve(){var y=M.localDescription.sdp.split(`
`);y.forEach(function(j){j&&j.indexOf("a=candidate:")===0&&ie(j)})}}var N=[],E=[],A=[],B=[];o.mediaDevices&&o.mediaDevices.enumerateDevices&&(o.enumerateDevices=function(t){var i=o.mediaDevices.enumerateDevices();i&&i.then?o.mediaDevices.enumerateDevices().then(t).catch(function(){t([])}):t([])});var te=!1;(typeof MediaStreamTrack<"u"&&"getSources"in MediaStreamTrack||o.mediaDevices&&o.mediaDevices.enumerateDevices)&&(te=!0);var X=!1,K=!1,Y=!1,F=!1,V=!1;function Te(t){if(!te){t&&t();return}if(!o.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(o.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!o.enumerateDevices&&o.enumerateDevices&&(o.enumerateDevices=o.enumerateDevices.bind(o)),!o.enumerateDevices){t&&t();return}N=[],E=[],A=[],B=[],X=!1,K=!1,Y=!1,F=!1,V=!1;var i={};o.enumerateDevices(function(r){N=[],E=[],A=[],B=[],r.forEach(function(c){var n={};for(var p in c)try{typeof c[p]!="function"&&(n[p]=c[p])}catch{}i[n.deviceId+n.label+n.kind]||(n.kind==="audio"&&(n.kind="audioinput"),n.kind==="video"&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?(n.kind==="videoinput"&&!V&&(V=!0),n.kind==="audioinput"&&!F&&(F=!0)):(n.isCustomLabel=!0,n.kind==="videoinput"?n.label="Camera "+(B.length+1):n.kind==="audioinput"?n.label="Microphone "+(E.length+1):n.kind==="audiooutput"?n.label="Speaker "+(A.length+1):n.label="Please invoke getUserMedia once.",typeof e<"u"&&e.browser.isChrome&&e.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&typeof document<"u"&&typeof document.domain=="string"&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),n.kind==="audioinput"&&(X=!0,E.indexOf(n)===-1&&E.push(n)),n.kind==="audiooutput"&&(K=!0,A.indexOf(n)===-1&&A.push(n)),n.kind==="videoinput"&&(Y=!0,B.indexOf(n)===-1&&B.push(n)),N.push(n),i[n.deviceId+n.label+n.kind]=n)}),typeof e<"u"&&(e.MediaDevices=N,e.hasMicrophone=X,e.hasSpeakers=K,e.hasWebcam=Y,e.isWebsiteHasWebcamPermissions=V,e.isWebsiteHasMicrophonePermissions=F,e.audioInputDevices=E,e.audioOutputDevices=A,e.videoInputDevices=B),t&&t()})}var e=window.DetectRTC||{};e.browser=b(),z(function(t){e.browser.isPrivateBrowsing=!!t}),e.browser["is"+e.browser.name]=!0,e.osName=d,e.osVersion=v,typeof process=="object"&&typeof process.versions=="object"&&process.versions["node-webkit"];var oe=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(t){oe||t in window&&(oe=!0)}),e.isWebRTCSupported=oe,e.isORTCSupported=typeof RTCIceGatherer<"u";var W=!1;if((e.browser.isChrome&&e.browser.version>=35||e.browser.isFirefox&&e.browser.version>=34||e.browser.isEdge&&e.browser.version>=17||e.osName==="Android"&&e.browser.isChrome)&&(W=!0),(o.getDisplayMedia||o.mediaDevices&&o.mediaDevices.getDisplayMedia)&&(W=!0),!/^(https:|chrome-extension:)$/g.test(location.protocol||"")){var Oe=typeof document<"u"&&typeof document.domain=="string"&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1;(Oe&&(e.browser.isChrome||e.browser.isEdge||e.browser.isOpera)||e.browser.isFirefox)&&(W=!1)}e.isScreenCapturingSupported=W;var _={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(t){_.isSupported||t in window&&(_.isSupported=!0,window[t]&&"createMediaStreamSource"in window[t].prototype&&(_.isCreateMediaStreamSourceSupported=!0))}),e.isAudioContextSupported=_.isSupported,e.isCreateMediaStreamSourceSupported=_.isCreateMediaStreamSourceSupported;var ce=!1;e.browser.isChrome&&e.browser.version>31&&(ce=!0),e.isRtpDataChannelsSupported=ce;var J=!1;(e.browser.isFirefox&&e.browser.version>28||e.browser.isChrome&&e.browser.version>25||e.browser.isOpera&&e.browser.version>=11)&&(J=!0),e.isSctpDataChannelsSupported=J,e.isMobileDevice=h;var $=!1;(o.getUserMedia||o.mediaDevices&&o.mediaDevices.getUserMedia)&&($=!0),e.browser.isChrome&&e.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&typeof document<"u"&&typeof document.domain=="string"&&document.domain.search&&document.domain.search(/localhost|127.0./g)===-1&&($="Requires HTTPs"),e.osName==="Nodejs"&&($=!1),e.isGetUserMediaSupported=$;var le="";if(screen.width){var Me=screen.width?screen.width:"",xe=screen.height?screen.height:"";le+=""+Me+" x "+xe}e.displayResolution=le;function De(t,i){function r(n,p){return p==0?n:r(p,n%p)}var c=r(t,i);return t/c/(i/c)}e.displayAspectRatio=De(screen.width,screen.height).toFixed(2),e.isCanvasSupportsStreamCapturing=Z,e.isVideoSupportsStreamCapturing=ee,e.browser.name=="Chrome"&&e.browser.version>=53&&(e.isCanvasSupportsStreamCapturing||(e.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),e.isVideoSupportsStreamCapturing||(e.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),e.DetectLocalIPAddress=Ce,e.isWebSocketsSupported="WebSocket"in window&&window.WebSocket.CLOSING===2,e.isWebSocketsBlocked=!e.isWebSocketsSupported,e.osName==="Nodejs"&&(e.isWebSocketsSupported=!0,e.isWebSocketsBlocked=!1),e.checkWebSocketsSupport=function(t){t=t||function(){};try{var i,r=new WebSocket("wss://echo.websocket.org:443/");r.onopen=function(){e.isWebSocketsBlocked=!1,i=new Date().getTime(),r.send("ping")},r.onmessage=function(){e.WebsocketLatency=new Date().getTime()-i+"ms",t(),r.close(),r=null},r.onerror=function(){e.isWebSocketsBlocked=!0,t()}}catch{e.isWebSocketsBlocked=!0,t()}},e.load=function(t){t=t||function(){},Te(t)},typeof N<"u"?e.MediaDevices=N:e.MediaDevices=[],e.hasMicrophone=X,e.hasSpeakers=K,e.hasWebcam=Y,e.isWebsiteHasWebcamPermissions=V,e.isWebsiteHasMicrophonePermissions=F,e.audioInputDevices=E,e.audioOutputDevices=A,e.videoInputDevices=B;var ue=!1;typeof document<"u"&&typeof document.createElement=="function"&&"setSinkId"in document.createElement("video")&&(ue=!0),e.isSetSinkIdSupported=ue;var ne=!1;e.browser.isFirefox&&typeof mozRTCPeerConnection<"u"?"getSenders"in mozRTCPeerConnection.prototype&&(ne=!0):e.browser.isChrome&&typeof webkitRTCPeerConnection<"u"&&"getSenders"in webkitRTCPeerConnection.prototype&&(ne=!0),e.isRTPSenderReplaceTracksSupported=ne;var pe=!1;e.browser.isFirefox&&e.browser.version>38&&(pe=!0),e.isRemoteStreamProcessingSupported=pe;var fe=!1;typeof MediaStreamTrack<"u"&&"applyConstraints"in MediaStreamTrack.prototype&&(fe=!0),e.isApplyConstraintsSupported=fe;var me=!1;e.browser.isFirefox&&e.browser.version>=43&&(me=!0),e.isMultiMonitorScreenCapturingSupported=me,e.isPromisesSupported="Promise"in window,e.version="1.4.1",typeof e>"u"&&(window.DetectRTC={});var q=window.MediaStream;typeof q>"u"&&typeof webkitMediaStream<"u"&&(q=webkitMediaStream),typeof q<"u"&&typeof q=="function"?e.MediaStream=Object.keys(q.prototype):e.MediaStream=!1,typeof MediaStreamTrack<"u"?e.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):e.MediaStreamTrack=!1;var we=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;typeof we<"u"?e.RTCPeerConnection=Object.keys(we.prototype):e.RTCPeerConnection=!1,window.DetectRTC=e,f.exports=e})()}(ae)),ae.exports}var H=Pe();function Ee(f,l){f.forEach(b=>{b.subjID=l,b.correct=b.targetWord===b.chosenWord});const u=["subjID","trial","wordClass","targetWord","chosenWord","chosenCategory","chosenPosition","correct","timestamp","responseTime"],o=["id","trial","word_class","target_word","chosen_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"],h=[];h.push(o),f.forEach(b=>{const I=u.map(P=>b[P]);h.push(I)});let m="";h.forEach(b=>{m+=b.join(",")+`
`});const g=new Date().toISOString().substring(0,10),C=new Date().toISOString().slice(11,19).replaceAll(":","-"),O=new Blob([m],{type:"text/csv;charset=utf-8,"}),w=URL.createObjectURL(O),k=document.createElement("a");k.setAttribute("href",w),k.setAttribute("download",`orev-${l}-${g}-${C}.csv`),k.click()}function Ae(f,l){f.forEach(w=>{w.subjID=l,w.correct=w.targetWord===w.chosenWord});const u=["subjID","trial","wordClass","targetWord","chosenWord","chosenCategory","chosenPosition","correct","timestamp","responseTime"],o=["id","trial","word_class","target_word","chosen_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"],h=[];h.push(o),f.forEach(w=>{const k=u.map(b=>w[b]);h.push(k)});let m="";h.forEach(w=>{m+=w.join(",")+`
`});const g=new Date().toISOString().substring(0,10),C=new Date().toISOString().slice(11,19).replaceAll(":","-"),O=new FormData;O.append("csvFile",new Blob([m],{type:"text/csv"}),`orev-${l}-${g}-${C}.csv`),fetch("./data/data.php",{method:"POST",body:O}).then(w=>w.text()).then(w=>{console.log("Success:",w)}).catch(w=>{console.error("Error:",w)})}const x=f=>new Promise(l=>setTimeout(l,f)),Be=()=>{const f=document.documentElement;f.requestFullscreen?f.requestFullscreen():f.webkitRequestFullscreen?f.webkitRequestFullscreen():f.msRequestFullscreen&&f.msRequestFullscreen()},Ne=()=>{let f=!1;if("maxTouchPoints"in navigator)f=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)f=navigator.msMaxTouchPoints>0;else{const l=window.matchMedia&&matchMedia("(pointer:coarse)");if(l&&l.media==="(pointer:coarse)")f=!!l.matches;else if("orientation"in window)f=!0;else{const u=navigator.userAgent;f=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(u)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(u)}}return f},he=localStorage.getItem("storedChoices");let D;he?D=JSON.parse(he):console.error("No data found in local storage");document.addEventListener("DOMContentLoaded",function(){const f=document.querySelectorAll(".trials");f.forEach((s,a)=>{s.id=`trial${a}`});const l={meta:{subjID:(D==null?void 0:D.subjID)||"testID",order:window.location.pathname.split("/").pop().replace(".html",""),touchscreen:Ne(),webcam:(D==null?void 0:D.webcam)==="true"||!1,saving:(D==null?void 0:D.saving)||"download"},data:[]};H.load(()=>{l.meta.os=H.osName,l.meta.browser=H.browser.name,l.meta.browserVersion=JSON.stringify(H.browser.version),l.meta.safari=H.browser.isSafari||!1,l.meta.iOSSafari=l.meta.touchscreen&&l.meta.safari});let u=0,o=0,h=0;const m=document.getElementsByTagName("audio"),g=document.getElementById("between-trials"),C=document.getElementById("orev-button"),O=document.getElementById("speaker"),w=document.getElementById("heading-fullscreen"),k=document.getElementById("heading-testsound"),b=async s=>{s.preventDefault(),h=new Date().getTime();const a=document.getElementById(`trial${u-1}`);Array.from(a.getElementsByTagName("img")).forEach(v=>{v.style.border="0.3vw solid black"}),s.target.style.border="0.3vw solid blue",l.data[u-2]={timestamp:new Date(parseInt(h)).toISOString(),responseTime:h-o,trial:u-1,targetWord:m[u-1].src.split("/").pop().replace("N_","").replace("V_","").replace("zm_","").replace(".mp3",""),chosenWord:s.target.src.split("/").pop().replace("N_","").replace("V_","").replace(".jpeg",""),chosenCategory:s.target.dataset.wordCategory,chosenPosition:s.target.classList[0],wordClass:m[u-1].src.split("/").pop().startsWith("N_")?"noun":m[u-1].src.split("/").pop().startsWith("V_")?"verb":"unknown"},C.addEventListener("click",I,{capture:!1,once:!0})},I=async s=>{if(s.preventDefault(),u===0&&(!0&!l.meta.iOSSafari&&Be(),w.style.display="none",k.style.display="inline",O.setAttribute("visibility","visible"),await x(1e3),m[u].play(),await x(1e3),C.addEventListener("click",I,{capture:!1,once:!0})),u===f.length){if(l.meta.saving==="download"){if(Ee(l.data,l.meta.subjID),!l.meta.iOSSafari&&l.meta.webcam){U.stopRecorder();const a=new Date().toISOString().substring(0,10),d=new Date().toISOString().slice(11,19).replaceAll(":","-");await x(2e3),U.downloadVideo(`orev-${l.meta.subjID}-${a}-${d}`),await x(2e3)}window.location.href="./goodbye.html"}else if(l.meta.saving==="upload"){if(Ae(l.data,l.meta.subjID),!l.meta.iOSSafari&&l.meta.webcam){U.stopRecorder(),U.modalContent(`<img src='/orev-vn/images/spinner-upload-de.svg' style="width: 75vw">`,"#E1B4B4");const a=new Date().toISOString().substring(0,10),d=new Date().toISOString().slice(11,19).replaceAll(":","-");await x(2e3),U.uploadVideo({fname:`orev-${l.meta.subjID}-${a}-${d}`,uploadContent:`<img src='/orev-vn/images/spinner-upload-de.svg' style="width: 75vw">`,uploadColor:"#E1B4B4",successContent:`<img src='/orev-vn/images/spinner-done-de.svg' style="width: 75vw">`,successColor:"#D3F9D3"},"./data/upload_video.php"),await x(2e4)}await x(2e3),D.subjID=l.meta.subjID,window.location.href=`https://devpsy.web.leuphana.de/orev-consent/goodbye.html?subjID=${l.meta.subjID}`}}if(u>0){k.style.display="none",m[u-1].pause(),m[u-1].currentTime=0;const a=document.getElementById(`trial${u-1}`);a.style.display="none",g.style.display="flex",await x(150),m[u].play(),await x(0),o=new Date().getTime(),g.style.display="none";const d=document.getElementById(`trial${u}`);d.style.display="flex";const v=Array.from(d.getElementsByTagName("img"));m[u].onended=()=>{v.forEach(T=>{T.addEventListener("click",b,{capture:!1,once:!1})})}}u++},P=async s=>{s.preventDefault(),u>1&&(m[u-1].pause(),m[u-1].currentTime=0),m[u-1].play()};C.addEventListener("click",I,{capture:!1,once:!0}),O.addEventListener("click",P,{capture:!1,once:!1}),(async()=>{await x(500),!l.meta.iOSSafari&&l.meta.webcam&&U.startRecorder({audio:!0,video:{frameRate:{min:3,ideal:3,max:3},width:{min:80,ideal:80,max:80},height:{min:60,ideal:60,max:60},facingMode:"user"}}),await x(2500),C.style.display="inline",C.disabled=!1})()});
